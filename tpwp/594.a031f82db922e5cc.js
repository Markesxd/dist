"use strict";(self.webpackChunktpwp=self.webpackChunktpwp||[]).push([[594],{7594:(O,m,a)=>{a.r(m),a.d(m,{HealthComponent:()=>x});var h=a(6814),t=a(9468),r=a(95);class v{createFromForm(c){this.nome=c.get("name")?.value,this.data=c.get("date")?.value,this.gatos=c.get("cats")?.value,this.intervaloDeRepeticao=Number(c.get("repeatInterval")?.value)}}var l=function(s){return s[s.NO_REPEAT=0]="NO_REPEAT",s[s.DAILY=1]="DAILY",s[s.WEEKLY=2]="WEEKLY",s[s.MONTHLY=3]="MONTHLY",s[s.YEARLY=4]="YEARLY",s}(l||{});let f=(()=>{class s{transform(e){switch(e){case l.WEEKLY:return"Semanal";case l.DAILY:return"Diario";case l.MONTHLY:return"Mensal";case l.NO_REPEAT:return"\xdanico";case l.YEARLY:return"Anual"}}static#t=this.\u0275fac=function(n){return new(n||s)};static#e=this.\u0275pipe=t.Yjl({name:"FormatRepeatInterval",type:s,pure:!0,standalone:!0})}return s})();var Z=a(6933),T=a(2187),b=a(7398),E=a(553),F=a(9862);let p=(()=>{class s{constructor(e){this.http=e,this.baseUrl=E.N.apiUrl+"/evento"}post(e){return this.http.post(this.baseUrl,e,{observe:"response"}).pipe((0,b.U)(n=>n.body))}fetch(){return this.http.get(this.baseUrl)}put(e){return this.http.put(this.baseUrl,e,{observe:"response"})}delete(e){return this.http.delete(`${this.baseUrl}/${e}`,{observe:"response"})}static#t=this.\u0275fac=function(n){return new(n||s)(t.LFG(F.eN))};static#e=this.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var d=a(2746);function A(s,c){if(1&s){const e=t.EpF();t.O4$(),t.TgZ(0,"svg",18),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onDelete())}),t._UZ(1,"path",19),t.qZA()}}function _(s,c){if(1&s&&(t.TgZ(0,"option",20),t._uU(1),t.ALo(2,"FormatRepeatInterval"),t.qZA()),2&s){const e=c.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(t.lcZ(2,2,e))}}function w(s,c){if(1&s){const e=t.EpF();t.TgZ(0,"div",21)(1,"input",22),t.NdJ("change",function(o){t.CHM(e);const i=t.oxw();return t.KtG(i.onChangeCat(o))}),t.qZA(),t.TgZ(2,"label",23),t._uU(3),t.qZA()()}if(2&s){const e=c.$implicit;t.xp6(1),t.MGl("id","i",e.id,""),t.Q6J("value",e.id),t.xp6(1),t.MGl("for","i",e.id,""),t.xp6(1),t.Oqu(e.nome)}}let N=(()=>{class s{constructor(e,n,o,i,u){this.fb=e,this.catService=n,this.eventService=o,this.activeModal=i,this.modalService=u,this.repeatIntervalValues=Object.values(l).filter(M=>!isNaN(M)),this.isNew=!0,this.delete=new t.vpe,this.editForm=this.fb.group({name:["",[r.kI.required]],date:[new Date,[r.kI.required]],repeatInterval:l.NO_REPEAT,cats:[[]]})}ngOnInit(){this.catService.get().subscribe(e=>{this.cats=e.body})}onChangeCat(e){const n=e.target;if(null===n)return;const o=Number(n.value);if(n.checked){const i=this.getCatById(o);if(!i)return;this.pushCat(i)}else this.removeCat(o)}onSubmit(){const e=new v;e.createFromForm(this.editForm),this.activeModal.close(e)}onDelete(){const e=this.modalService.open(Z.Y,{centered:!0});e.componentInstance.text="Voc\xea tem certeza que deseja excluir este evento?",e.closed.subscribe(()=>{this.delete.emit(),this.activeModal.dismiss()})}dismiss(){this.activeModal.dismiss()}get formCats(){const e=this.editForm.get("cats")?.value;if(!Array.isArray(e))throw new Error("Cats is not an array!");return e}getCatById(e){return this.cats?.find(n=>n.id===e)}pushCat(e){const n=this.formCats;n.push(e),this.editForm.patchValue({cats:n})}removeCat(e){this.editForm.patchValue({cats:this.formCats.filter(o=>o.id!==e)})}firstTimeLoadCats(e){for(const n of e)this.firstTimeLoadCat(n)}firstTimeLoadDate(){const e=document.querySelector("#date"),n=this.editForm.get("date")?.value??new Date;e.value=function g(s){return`${s.getFullYear()}-${function C(s){return s<10?`0${s}`:`${s}`}(s.getMonth())}-${s.getDate()}`}(n)}firstTimeLoadCat(e){const n=document.querySelector(`#i${e.id}`);n?n.checked=!0:setTimeout(()=>this.firstTimeLoadCat(e),100)}static#t=this.\u0275fac=function(n){return new(n||s)(t.Y36(r.qu),t.Y36(T.q),t.Y36(p),t.Y36(d.Kz),t.Y36(d.FF))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["create-health-event"]],outputs:{delete:"delete"},standalone:!0,features:[t.jDz],decls:28,vars:7,consts:[[1,"p-3"],[1,"form-header"],[1,"form-title"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 384 512",1,"form-icon",3,"click"],["d","M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"],[3,"formGroup","ngSubmit"],["for","name",1,"form-label"],[1,"d-flex","align-items-center","gap-2"],["type","text","id","name","formControlName","name",1,"form-control"],["xmlns","http://www.w3.org/2000/svg","height","1em","viewBox","0 0 448 512",3,"click",4,"ngIf"],["for","date",1,"form-label"],["type","date","id","date","formControlName","date",1,"form-control"],["for","repeat",1,"form-label"],["formControlName","repeatInterval","id","repeat",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],[1,"form-label"],["class","form-check",4,"ngFor","ngForOf"],["type","submit",1,"form-buttom",3,"disabled"],["xmlns","http://www.w3.org/2000/svg","height","1em","viewBox","0 0 448 512",3,"click"],["d","M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"],[3,"value"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"id","value","change"],[1,"mt-1",3,"for"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h3",2),t._uU(3),t.qZA(),t.O4$(),t.TgZ(4,"svg",3),t.NdJ("click",function(){return o.dismiss()}),t._UZ(5,"path",4),t.qZA()(),t.kcU(),t.TgZ(6,"form",5),t.NdJ("ngSubmit",function(){return o.onSubmit()}),t.TgZ(7,"div")(8,"label",6),t._uU(9,"Nome"),t.qZA(),t.TgZ(10,"div",7),t._UZ(11,"input",8),t.YNc(12,A,2,0,"svg",9),t.qZA()(),t.TgZ(13,"div")(14,"label",10),t._uU(15,"Data"),t.qZA(),t._UZ(16,"input",11),t.qZA(),t.TgZ(17,"div")(18,"label",12),t._uU(19,"Intervalo de Repeti\xe7\xe3o"),t.qZA(),t.TgZ(20,"select",13),t.YNc(21,_,3,4,"option",14),t.qZA()(),t.TgZ(22,"div")(23,"label",15),t._uU(24,"gatos"),t.qZA(),t.YNc(25,w,4,4,"div",16),t.qZA(),t.TgZ(26,"button",17),t._uU(27),t.qZA()()()),2&n&&(t.xp6(3),t.hij("",o.isNew?"Novo":""," Evento"),t.xp6(3),t.Q6J("formGroup",o.editForm),t.xp6(6),t.Q6J("ngIf",!o.isNew),t.xp6(9),t.Q6J("ngForOf",o.repeatIntervalValues),t.xp6(4),t.Q6J("ngForOf",o.cats),t.xp6(1),t.Q6J("disabled",!o.editForm.valid),t.xp6(1),t.Oqu(o.isNew?"Cadastrar":"Salvar"))},dependencies:[h.ez,h.sg,h.O5,r.UX,r._Y,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.JL,r.sg,r.u,f]})}return s})();var L=a(4144),Y=a(459),H=a(4408);function U(s,c){if(1&s){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"formatDate"),t.qZA(),t.TgZ(6,"td")(7,"span",7),t.O4$(),t.TgZ(8,"svg",2),t.NdJ("click",function(){const i=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.openModal(i))}),t._UZ(9,"path",8),t.qZA()()()()}if(2&s){const e=c.$implicit;t.xp6(2),t.Oqu(e.nome),t.xp6(2),t.Oqu(t.lcZ(5,2,e.data))}}let x=(()=>{class s{constructor(e,n,o,i){this.healthEventService=e,this.cookieService=n,this.router=o,this.modalService=i,this.showModal=!1}ngOnInit(){this.load()}openModal(e){const n=this.modalService.open(N,{centered:!0});if(e){const o=new Date(e.data??"");n.componentInstance.isNew=!1,n.componentInstance.editForm.patchValue({name:e.nome,date:o,repeatInterval:e.intervaloDeRepeticao}),n.componentInstance.firstTimeLoadCats(e.gatos),setTimeout(()=>{n.componentInstance.firstTimeLoadDate()},200),n.componentInstance.delete.subscribe(()=>this.deleteEvent(e))}n.closed.subscribe(o=>{void 0!==e?(o.id=e.id,this.healthEventService.put(o).subscribe(()=>{this.events=this.events?.filter(i=>i.id!==e.id),this.events?.push(o)})):this.healthEventService.post(o).subscribe(i=>{this.events?.push(i)})})}deleteEvent(e){if(!e.id)throw new Error("Evento sem id");this.healthEventService.delete(e.id).subscribe(()=>{this.events=this.events?.filter(n=>n!==e)})}load(){this.healthEventService.fetch().subscribe(e=>{this.events=e})}static#t=this.\u0275fac=function(n){return new(n||s)(t.Y36(p),t.Y36(Y.N),t.Y36(H.F0),t.Y36(d.FF))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-health"]],standalone:!0,features:[t.jDz],decls:16,vars:1,consts:[[1,"page-header"],[1,"page-title"],["xmlns","http://www.w3.org/2000/svg","height","1em","viewBox","0 0 512 512",3,"click"],["d","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM232 344V280H168c-13.3 0-24-10.7-24-24s10.7-24 24-24h64V168c0-13.3 10.7-24 24-24s24 10.7 24 24v64h64c13.3 0 24 10.7 24 24s-10.7 24-24 24H280v64c0 13.3-10.7 24-24 24s-24-10.7-24-24z"],[1,"health-content"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between"],["d","M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"h2",1),t._uU(2,"Sa\xfade"),t.qZA(),t.O4$(),t.TgZ(3,"svg",2),t.NdJ("click",function(){return o.openModal()}),t._UZ(4,"path",3),t.qZA()(),t.kcU(),t.TgZ(5,"section",4)(6,"table",5)(7,"thead")(8,"tr")(9,"th"),t._uU(10,"Evento"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"data"),t.qZA(),t._UZ(13,"th"),t.qZA()(),t.TgZ(14,"tbody"),t.YNc(15,U,10,4,"tr",6),t.qZA()()()),2&n&&(t.xp6(15),t.Q6J("ngForOf",o.events))},dependencies:[h.ez,h.sg,L.r],styles:[".health-content[_ngcontent-%COMP%]{padding:1rem}"]})}return s})()}}]);